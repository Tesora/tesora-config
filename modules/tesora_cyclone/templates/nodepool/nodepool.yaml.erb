script-dir: /etc/nodepool/scripts
elements-dir: /etc/nodepool/elements
images-dir: /opt/nodepool_dib
dburi: 'mysql://nodepool:<%= mysql_password %>@localhost/nodepool'

cron:
  cleanup: '*/1 * * * *'
  check: '*/1 * * * *'
  # DISABLE image-update. (Feb 31 does not exist.)
  image-update: '0 5 31 2 *'

zmq-publishers:
  - tcp://jenkins01.elasticdb.org:8888

gearman-servers:
  - host: zuul.elasticdb.org

labels:
#  - name: devstack-precise
#    image: devstack-precise
#    ready-script: configure_mirror.sh
#    min-ready: 1
#    providers:
#      - name: bluebox
#  - name: devstack-precise-check
#    image: devstack-precise-check
#    min-ready: 0
#    providers:
#      - name: bluebox
#  - name: bare-precise
#    image: bare-precise
#    ready-script: configure_mirror.sh
#    min-ready: 1
#    providers:
#      - name: bluebox
  - name: devstack-trusty
    image: devstack-trusty
    ready-script: configure_mirror.sh
    min-ready: 4
    providers:
      - name: bluebox
  - name: bare-trusty
    image: bare-trusty
    ready-script: configure_mirror.sh
    min-ready: 2
    providers:
      - name: bluebox
  - name: bare-precise
    image: bare-precise
    ready-script: configure_mirror.sh
    min-ready: 1
    providers:
      - name: bluebox
  - name: bare-centos6
    image: bare-centos6
    ready-script: configure_mirror.sh
    min-ready: -1 
    providers:
      - name: bluebox
  - name: py3k-precise
    image: py3k-precise
    ready-script: configure_mirror.sh
    min-ready: 1
    providers:
      - name: bluebox

providers:
  - name: bluebox
    region-name: ''
    service-type: 'compute'
    service-name: 'nova'
    username: '<%= bluebox_username %>'
    password: '<%= bluebox_password %>'
    project-id: '<%= bluebox_project %>'
    auth-url: 'https://tesora-iad.openstack.blueboxgrid.com:5001/v2.0'
    boot-timeout: 180
    max-servers: 10
    rate: 0.5
    networks:
      - net-label: 'internal'
    images:
#      - name: devstack-precise
#        base-image: 'Ubuntu 12.04 LTS (Precise Pangolin)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_devstack.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa
#      - name: bare-precise
#        base-image: 'Ubuntu 12.04 LTS (Precise Pangolin)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_bare.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa
      - name: devstack-trusty
        base-image: 'ubuntu-14.04'
        min-ram: 8192
        name-filter: 'm1.large'
        setup: prepare_node_devstack.sh
        username: jenkins
        private-key: /home/nodepool/.ssh/id_rsa
      - name: bare-trusty
        base-image: 'ubuntu-14.04'
        min-ram: 8192
        name-filter: 'm1.large'
        setup: prepare_node_bare.sh
        username: jenkins
        private-key: /home/nodepool/.ssh/id_rsa
      - name: bare-precise
        base-image: 'ubuntu-12.04'
        min-ram: 8192
        name-filter: 'm1.large'
        setup: prepare_node_bare.sh
        username: jenkins
        private-key: /home/nodepool/.ssh/id_rsa
      - name: bare-centos6
        base-image: 'centos-6.5-ci-!requiretty'
        min-ram: 8192
        name-filter: 'm1.large'
        setup: prepare_node_bare.sh
        username: jenkins
        private-key: /home/nodepool/.ssh/id_rsa
      - name: py3k-precise
        base-image: 'ubuntu-12.04'
        min-ram: 8192
        name-filter: 'm1.large'
        setup: prepare_node_py3k.sh
        username: jenkins
        private-key: /home/nodepool/.ssh/id_rsa
#      - name: devstack-f20
#        base-image: 'Fedora 20 (Heisenbug) (PVHVM)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_devstack.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa
#      - name: bare-f20
#        base-image: 'Fedora 20 (Heisenbug) (PVHVM)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_bare.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa
#      - name: devstack-f20-virt-preview
#        base-image: 'Fedora 20 (Heisenbug) (PVHVM)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_devstack_virt_preview.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa
#      - name: devstack-centos7
#        base-image: 'CentOS 7 (PVHVM)'
#        min-ram: 8192
#        name-filter: 'Performance'
#        setup: prepare_node_devstack.sh
#        username: jenkins
#        private-key: /home/nodepool/.ssh/id_rsa

targets:
  - name: jenkins01
    jenkins:
      url: 'https://jenkins01.elasticdb.org/'
      user: '<%= jenkins_api_user %>'
      apikey: '<%= jenkins_api_key %>'
      credentials-id: '<%= jenkins_credentials_id %>'

diskimages:
  - name: devstack-trusty-dib
    elements:
      - ubuntu
      - vm
      - openstack-repos
      - puppet
      - nodepool-base
      - node-devstack
    release: trusty
